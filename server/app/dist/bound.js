!function(e){function n(i){if(t[i])return t[i].exports;var s=t[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}var t={};return n.m=e,n.c=t,n.p="/app/dist/",n(0)}([function(e,n,t){(function(e){"use strict";function n(){i(),e(".main").contents().remove();var n=a.home();e(".main").append(n),e(".start-btn").click(function(){r.emit("luckEvent")})}function i(){null!=v&&(clearInterval(v),v=null)}function s(){i(),e(".main").contents().remove();var n=a.luck();e(".main").append(n),e(".round-pan").height(e(".round-pan").width()),e(".myAwardBtn .myaward_btn").click(function(){r.emit("PopupEvent.myAwardEvent")}),e(".zhizheng").click(function(){return m.leave_times<=0?void alert("你今天的摇奖次数已用完！"):void c.getAward().then(function(n){return m.leave_times<=0?void alert("你今天的摇奖次数已用完！"):(l=n.rotate+360*u,u+=3,r.emit("coverEvent"),void e(".round-pan").animate({d:l},{step:function(n,t){e(this).css("-webkit-transform","rotate("+n+"deg)"),e(this).css("-moz-transform","rotate("+n+"deg)"),e(this).css("transform","rotate("+n+"deg)")},duration:3e3,complete:function(){1==n.data.get?1==n.data.virtual?setTimeout(function(){r.emit("PopupEvent.virAwardEvent",n),r.emit("closeCoverEvent")},1e3):setTimeout(function(){r.emit("PopupEvent.realAward",n),r.emit("closeCoverEvent")},1e3):setTimeout(function(){r.emit("closeCoverEvent"),r.emit("PopupEvent.createFail")},1e3)}},"linear"))},function(e){console.log(e)})});var t=e(".light>img"),s=1;v=setInterval(function(){s>3&&(s=1),t.attr("src","/app/image/light"+s+".png"),s++},100),e(".rule-trigger").click(function(){r.emit("PopupEvent.rule")})}var a=(t(12),t(11)),r=t(5),o=t(9),c=t(7),d=t(4),l=-1,v=null,p=t(3),u=5,m=t(2);d.getUserId({loginid:p.getItem("loginid")||-1}).then(function(e){1==e.status&&(m.leave_times=e.times||0,p.saveItem("loginid",e.loginid))},function(){console.log("get user id error")}),r.on("homeEvent",function(){n()}),r.on("luckEvent",function(){s(),r.emit("PopupEvent.createFocus")}),r.on("PopupEvent.WriteMessage",function(e){o.createWriteMessage(e)}),r.on("PopupEvent.createFocus",function(){o.createFocus()}),r.on("PopupEvent.realAward",function(e){o.createRealAward(e)}),r.on("PopupEvent.virAwardEvent",function(e){o.createVirAward(e)}),r.on("PopupEvent.myAwardEvent",function(){o.createMyAward()}),r.on("coverEvent",function(){var n=e('<div class="cover"></div>');e(document.body).append(n)}),r.on("closeCoverEvent",function(){e(".cover").remove()}),r.on("PopupEvent.rule",function(){o.createRule()}),r.on("PopupEvent.createFail",function(){o.createFail()}),r.on("PopupEvent.createMessageSuccess",function(){o.createMessageSuccess()}),window.start=function(){r.emit("homeEvent")},window.alert=function(){o.DAlert([].concat(Array.prototype.slice.call(arguments)))}}).call(n,t(1))},function(e,n){e.exports=jQuery},function(e,n){"use strict";var t=2;e.exports={leave_times:t}},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),s=function(){function e(){t(this,e)}return i(e,[{key:"getItem",value:function(e){return window.localStorage[e]}},{key:"saveItem",value:function(e,n){window.localStorage[e]=n}}]),e}(),a=new s;e.exports=a},function(e,n,t){(function(n){"use strict";function i(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=n("<div class='best'><div>正在加载信息...</div></div>");n(document.body).append(i);var s=n.ajax({type:"GET",url:e,data:t,dataType:"json"});return s.then(function(){n(".best").remove()},function(){n(".best").remove()}),s}function s(){return i("/Home/Award/myaward",{loginid:d})}function a(){return i("/Home/Award/one",{loginid:d})}function r(e){return i("/Home/Award/loginid",e)}function o(e){return e.loginid=d,i("/Home/Award/setAward",e)}var c=t(3),d=c.getItem("loginid")||-1;e.exports={getMyAward:s,getAward:a,submitMessage:o,getUserId:r}}).call(n,t(1))},function(e,n,t){"use strict";var i=t(10),s=new i.EventEmitter;e.exports=s},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),s=function(){function e(n){t(this,e),this._data=n,this._pagesize=3,this._index=-1}return i(e,[{key:"next",value:function(){this._index++;var e=this.getData();return e||this._index--,e}},{key:"pre",value:function(){this._index--;var e=this.getData();return e||this._index++,e}},{key:"hasNext",value:function(){var e=this._index*this._pagesize,n=e+this._pagesize-1;return!(n+1>=this._data.length)}},{key:"hasPrev",value:function(){return this._index>0}},{key:"getData",value:function(){for(var e=[],n=this._index*this._pagesize,t=n+this._pagesize-1,i=n;t>=i&&"undefined"!=typeof this._data[i];i++)e.push(this._data[i]);return e.length>0?e:!1}}]),e}();e.exports=function(e){return new s(e)}},function(e,n,t){(function(n){"use strict";function i(e){var n=o.award_mapping,t=null;if(1!=e.get){var i=[43,-90];return i[Math.floor(Math.random()*i.length)]}for(var s=0;s<n.length;s++)n[s].id==e.id&&(t=n[s].rotate);return t}function s(){var e=n.Deferred();return a.getAward().then(function(n){var t=i(n);return r.leave_times=n.times||0,e.resolve({rotate:t,data:n})},function(){e.reject("摇奖接口发生异常")}),e.promise()}var a=t(4),r=t(2),o={award_mapping:[{id:1,name:"10元微店优惠券",rotate:0},{id:2,name:"手机壳",rotate:135},{id:3,name:"阳伞",rotate:-135},{id:4,name:"5元微店优惠券",rotate:-180},{id:5,name:"球衣",rotate:90},{id:6,name:"足球",rotate:-45}]};e.exports={local_award_info:o,getAward:s}}).call(n,t(1))},function(e,n){"use strict";!function(e){e.fn.citySelect=function(n){if(!(this.length<1)){n=e.extend({url:"js/city.min.js",prov:null,city:null,dist:null,nodata:null,required:!0},n);var t,i=this,s=i.find(".prov"),a=i.find(".city"),r=i.find(".dist"),o=(n.prov,n.city,n.dist,n.required?"":"<option value=''>请选择</option>"),c=function(){var i=s.get(0).selectedIndex;if(n.required||i--,a.empty().attr("disabled",!0),r.empty().attr("disabled",!0),0>i||"undefined"==typeof t.citylist[i].c)return void("none"==n.nodata?(a.css("display","none"),r.css("display","none")):"hidden"==n.nodata&&(a.css("visibility","hidden"),r.css("visibility","hidden")));var c=o;e.each(t.citylist[i].c,function(e,n){c+="<option value='"+n.n+"'>"+n.n+"</option>"}),a.html(c).attr("disabled",!1).css({display:"",visibility:""}),d()},d=function(){var i=s.get(0).selectedIndex,c=a.get(0).selectedIndex;if(n.required||(i--,c--),r.empty().attr("disabled",!0),0>i||0>c||"undefined"==typeof t.citylist[i].c[c].a)return void("none"==n.nodata?r.css("display","none"):"hidden"==n.nodata&&r.css("visibility","hidden"));var d=o;e.each(t.citylist[i].c[c].a,function(e,n){d+="<option value='"+n.s+"'>"+n.s+"</option>"}),r.html(d).attr("disabled",!1).css({display:"",visibility:""})},l=function(){var i=o;e.each(t.citylist,function(e,n){i+="<option value='"+n.p+"'>"+n.p+"</option>"}),s.html(i),setTimeout(function(){null!=n.prov&&(s.val(n.prov),c(),setTimeout(function(){null!=n.city&&(a.val(n.city),d(),setTimeout(function(){null!=n.dist&&r.val(n.dist)},1))},1))},1),s.bind("change",function(){c()}),a.bind("change",function(){d()})};"string"==typeof n.url?e.getJSON(n.url,function(e){t=e,l()}):(t=n.url,l())}}}(jQuery)},function(e,n,t){(function(n){"use strict";function i(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];y=n('<div class="popup"></div>'),n(document.body).append(y),e&&y.click(function(){n(this).remove(),n(".popup-content").remove(),y=null})}function s(){var e=arguments.length<=0||void 0===arguments[0]?{data:{gid:1}}:arguments[0],t=h.getItem("name")||"",s=h.getItem("address")||"",a=h.getItem("phone")||"",r='\n		<div class="write-message popup-content">\n			<div class="write-message-image"><img src="/app/image/message-bg.png"/></div>\n			<div class="write-form">\n				<input type=\'hidden\' value="'+e.data.gid+'" name=\'gid\'/>\n				<div class="write-item-manager">\n					<div class="write-item">\n						<div class="write-item-icon"><img src="/app/image/icon-1.png"/></div>\n						<div class=\'write-item-input\'><input type=\'text\' placeHolder="请输入姓名" name=\'username\' value=\''+t+"'/></div>\n					</div>\n\n					<div class=\"write-item\">\n						<div class=\"write-item-icon\"><img src=\"/app/image/icon-2.png\"/></div>\n						<div class='write-item-input'><input type='tel'  placeHolder=\"请输入手机号码\"  name='userphone' value='"+a+'\'/></div>\n					</div>\n\n			\n\n\n					<div class="write-item spec" id="scx">\n						<div class="shen"><select class=\'prov\'></select></div>\n						<div class="shi"><select class=\'city\'></select></div>\n						<div class="qu"><select class=\'dist\'></select></div>\n\n					</div>\n					\n					<div class="write-item">\n						<div class="write-item-icon"><img src="/app/image/icon-3.png"/></div>\n						<div class=\'write-item-input\'><input type=\'text\' placeHolder="请输入地址" name=\'useraddress\' value=\''+s+"'/></div>\n					</div>\n				</div>\n				<div class='write-message-submit-btn'><a href='javascript:void(0)'><img src=\"/app/image/submit-message.jpg\"/></a></div>\n			</div>\n		</div>\n	";i(!1),n(document.body).append(r),n("#scx").citySelect({url:"/app/js/city.min.js",prov:function(){return h.getItem("shen")||"北京"}(),city:function(){return h.getItem("shi")||"东城区"}(),dist:function(){return h.getItem("dist")||""}(),nodata:"none"}),n(".write-message-submit-btn>a").click(function(){var e=n("input[name='gid']").val(),t=n("input[name='username']").val(),i=n("input[name='userphone']").val(),s=n("input[name='useraddress']").val(),a=n(".prov").val(),r=n(".city").val(),o=n(".dist").val()||"";if(e.length<=0)return void alert("发生错误！请联系管理员!");if(t.length<=1)return void alert("请正确填写姓名");if(!/^1[0-9]{10}$/.test(i))return void alert("请正确填写手机号码");if(s.length<=5)return void alert("请正确填写地址");var c={gid:e,username:t,userphone:i,useraddress:a+r+o+s};h.saveItem("name",t),h.saveItem("phone",i),h.saveItem("address",s),h.saveItem("shen",a),h.saveItem("shi",r),h.saveItem("dist",o),g.submitMessage(c).then(function(e){p(),1==e.status?m.emit("PopupEvent.createMessageSuccess"):alert(e.info)},function(){p(),console.log("提交信息发生异常")})})}function a(){var e='\n		<div class="focus popup-content">\n			<div class=\'focus-tips\'><img src="/app/image/focus'+b.leave_times+'.png"/></div>\n\n			<div class="close-btn"><img src="/app/image/close-btn.jpg"/></div>\n		</div>\n	';i(),n(document.body).append(e),n(".close-btn").click(function(){p()})}function r(e){var t='\n		<div class="virAward popup-content">\n			<div class="vir-bg"><img src="'+e.data.pic+'"/>\n\n			<div class="vire-bg-close-btn"><img src="/app/image/close-btn2.png"/></div>\n			</div>\n				<div class="star-manager">\n					<div><img src="/app/image/star-left.png"/></div>\n					<div><img src="/app/image/star-middle.png"/></div>\n					<div><img src="/app/image/star-right.png"/></div>\n				</div>\n		</div>\n\n	';n(document.body).append(t),n(".vire-bg-close-btn").click(function(){p()}),i(!1)}function o(e){var t='\n			<div class="realAward popup-content">\n				<div class="star-manager">\n					<div><img src="/app/image/star-left.png"/></div>\n					<div><img src="/app/image/star-middle.png"/></div>\n					<div><img src="/app/image/star-right.png"/></div>\n				</div>\n\n				<div class="realAward-image">\n\n				<img src="'+e.data.pic+'"/>\n\n					<div class="realAward-close-btn"><img src="/app/image/close-btn2.png"/></div>\n\n				</div>\n\n\n				<!--<div class="realAwardImage"><img src="/app/image/quan.png"/></div>-->\n				<div class="realAwardBtn"><img src="/app/image/btn.png"/></div>\n			<div>\n	';i(!1),n(document.body).append(t),n(".realAwardBtn").click(function(){p(),m.emit("PopupEvent.WriteMessage",e)}),n(".realAward-close-btn").click(function(){p()})}function c(){g.getMyAward().then(function(e){var t=f(e.list),s='<div class="my-award-item">\n						<div class="my-award-left"><img src="/app/image/award-item-left.png"/><span>3.25</span></div>\n						<div class="my-award-middle">雨伞</div>\n						<div class="my-award-right">3</div>\n					</div>',a='\n			<div class="myAward popup-content">\n				<div class="xin-group">\n					<div><img src="/app/image/xin.png"/></div>\n					<div><img src="/app/image/xin.png"/></div>\n					<div><img src="/app/image/xin.png"/></div>\n				</div>\n\n				<div class="myaward-top"><img src="/app/image/my-top.png"/><span class="close-btn-2"><img src="/app/image/close-btn2.png"/></span></div>\n				<div class="myaward-middle">\n					\n				</div>\n				<div class="myaward-bottom"><img src="/app/image/my-bottom.png"/>\n					<div class="next-btn"><img src="/app/image/next.png"/></div>\n				</div>\n			<div>\n			';i(),n(document.body).append(a),n(".next-btn").click(function(){var e=t.next();if(e){n(".myaward-middle").contents().remove();for(var i=0;i<e.length;i++){var a=n(s);a.find(".my-award-left span").text(e[i].date),a.find(".my-award-middle").text(e[i].award_name),a.find(".my-award-right").text(e[i].award_number),n(".myaward-middle").append(a)}t.hasNext()||n(".next-btn").addClass("disabled")}else n(".next-btn").remove(),n(".myaward-middle").html("<div class='nodata'>暂时没有中奖数据！</div>")}),n(".next-btn").trigger("click"),n(".close-btn-2").click(function(){p()})},function(e){console.log("error in my award data")})}function d(){var e='\n			<div class="rule popup-content">\n				\n				<div class="rule-header"><img src="/app/image/rule-header.png"/>\n					\n					<div class="rule-close-btn"><img src="/app/image/close-btn2.png"/></div>\n\n				</div>\n				<div class="rule-content"><img src="/app/image/rule_content.png"/></div>\n\n\n\n			<div>\n	';i(!1),n(document.body).append(e),n(".rule-close-btn").click(function(){p()})}function l(){var e='\n			<div class="fail popup-content">\n				\n				<span>\n					<img src="/app/image/fail.png"/>\n					</span>\n\n\n			<div>\n	';i(!1),n(document.body).append(e),n(".fail").click(function(){p()})}function v(){var e='\n			<div class="messageSuccess popup-content">\n				\n				<div class=\'messageSuccess-content\'>\n					<div><img src="/app/image/message-success.png"/></div>\n					\n					<div class=\'myawardbtn2\'><img src="/app/image/myAwardBtn2.png"/></div>\n					<div class=\'message-close-btn\'><img src="/app/image/close-btn2.png"/></div>\n				</div>\n\n\n			<div>\n	';i(!1),n(document.body).append(e),n(".message-close-btn").click(function(){p()}),n(".myawardbtn2").click(function(){p(),m.emit("PopupEvent.myAwardEvent")})}function p(){y&&(y.remove(),n(".popup-content").remove(),y=null)}function u(e){var t='<div class="Alert">\n				\n				<div class="core">\n					<div class=\'core-msg\'>'+e+"</div>\n					<div class='core-close-btn'><a href='javascript:void(0)'>关闭</a></div>\n\n				</div>			\n\n			</div>";n(document.body).append(t),n(".core-close-btn").click(function(){n(this).unbind(),n(this).parents(".Alert").remove()})}var m=t(5),g=t(4),f=t(6),h=t(3),y=null,b=t(2),w=t(8);console.log(w),e.exports={createWriteMessage:s,createFocus:a,createRealAward:o,createVirAward:r,createMessageSuccess:v,createMyAward:c,createRule:d,createFail:l,DAlert:u}}).call(n,t(1))},function(e,n){"use strict";function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function s(e){return"number"==typeof e}function a(e){return"object"===("undefined"==typeof e?"undefined":o(e))&&null!==e}function r(e){return void 0===e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.exports=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},t.prototype.emit=function(e){var n,t,s,o,c,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(n=arguments[1],n instanceof Error)throw n;throw TypeError('Uncaught, unspecified "error" event.')}if(t=this._events[e],r(t))return!1;if(i(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),t.apply(this,o)}else if(a(t))for(o=Array.prototype.slice.call(arguments,1),d=t.slice(),s=d.length,c=0;s>c;c++)d[c].apply(this,o);return!0},t.prototype.addListener=function(e,n){var s;if(!i(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(n.listener)?n.listener:n),this._events[e]?a(this._events[e])?this._events[e].push(n):this._events[e]=[this._events[e],n]:this._events[e]=n,a(this._events[e])&&!this._events[e].warned&&(s=r(this._maxListeners)?t.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(e,n){function t(){this.removeListener(e,t),s||(s=!0,n.apply(this,arguments))}if(!i(n))throw TypeError("listener must be a function");var s=!1;return t.listener=n,this.on(e,t),this},t.prototype.removeListener=function(e,n){var t,s,r,o;if(!i(n))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(t=this._events[e],r=t.length,s=-1,t===n||i(t.listener)&&t.listener===n)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,n);else if(a(t)){for(o=r;o-- >0;)if(t[o]===n||t[o].listener&&t[o].listener===n){s=o;break}if(0>s)return this;1===t.length?(t.length=0,delete this._events[e]):t.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,n)}return this},t.prototype.removeAllListeners=function(e){var n,t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[e],i(t))this.removeListener(e,t);else if(t)for(;t.length;)this.removeListener(e,t[t.length-1]);return delete this._events[e],this},t.prototype.listeners=function(e){var n;return n=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},t.prototype.listenerCount=function(e){if(this._events){var n=this._events[e];if(i(n))return 1;if(n)return n.length}return 0},t.listenerCount=function(e,n){return e.listenerCount(n)}},function(e,n){"use strict";function t(){return'<div class="home">\n				<div class="index-top">\n					<div class="title"><img src="/app/image/title.png"/></div>\n					<div class="dai">\n						<div class=\'dai-bg\'><img src="/app/image/top.png"/></div>\n						<div class="a-dai"><img src="/app/image/a-dai.png"/></div>\n					</div>\n				</div>\n				<div class="index-bottom">\n					<div class="start-btn"><a href=\'javascript:void(0)\'><img src="/app/image/btn-index.png"/></a></div>\n					<div class="index-logo"><img src="/app/image/logo-index.png"/></div>\n					<img src="/app/image/index-bottom.png" class=\'ib-bg\'/>\n				</div>\n\n				<div class="caidai">\n					<div class=\'dai-bg\'><img src="/app/image/caidai.png"/></div>\n				</div>\n			</div>'}function i(){return'<div class="luck">\n			<div class="luck-title">\n				<img src="/app/image/title2.png"/>\n				\n				<div class="jingbi"><img src="/app/image/luck-ani-1.png"/></div>\n				<div class="bao"><img src="/app/image/luck-ani-2.png"/></div>\n			</div>	\n		\n			<div class="pan">\n				<div class="round-pan"><img src="/app/image/pan.png"/></div>\n				<div class="zhizheng"><img src="/app/image/zhizheng.png"/></div>\n\n				<div class="light">\n					<img src="/app/image/light1.png"/>\n				</div>\n			</div>\n			<div class="myAwardBtn">\n\n				<div><a href=\'javascript:void(0)\' class=\'rule-trigger\'><img src="/app/image/rule_btn.png"/></a></div>\n				<div><a href=\'javascript:void(0)\'><img src="/app/image/times.png"/></a></div>\n				<div><a href=\'javascript:void(0)\' class=\'myaward_btn\'><img src="/app/image/myAwardBtn.png"/></a></div>\n\n\n			</div>\n		</div>'}e.exports={home:t,luck:i}},function(e,n){}]);