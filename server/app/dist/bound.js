!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="/app/dist/",t(0)}([function(e,t,n){(function(e){"use strict";function t(){i(),e(".main").contents().remove();var t=a.home();e(".main").append(t),e(".start-btn").click(function(){r.emit("luckEvent")})}function i(){null!=v&&(clearInterval(v),v=null)}function s(){i(),e(".main").contents().remove();var t=a.luck();e(".main").append(t),e(".round-pan").height(e(".round-pan").width()),e(".myAwardBtn .myaward_btn").click(function(){r.emit("PopupEvent.myAwardEvent")}),e(".zhizheng").click(function(){return m.leave_times<=0?void alert("你今天的摇奖次数已用完！"):void c.getAward().then(function(t){return m.leave_times<=0?void alert("你今天的摇奖次数已用完！"):(l=t.rotate+360*u,u+=3,r.emit("coverEvent"),void e(".round-pan").animate({d:l},{step:function(t,n){e(this).css("-webkit-transform","rotate("+t+"deg)"),e(this).css("-moz-transform","rotate("+t+"deg)"),e(this).css("transform","rotate("+t+"deg)")},duration:3e3,complete:function(){1==t.data.get?1==t.data.virtual?setTimeout(function(){r.emit("PopupEvent.virAwardEvent",t),r.emit("closeCoverEvent")},1e3):setTimeout(function(){r.emit("PopupEvent.realAward",t),r.emit("closeCoverEvent")},1e3):setTimeout(function(){r.emit("closeCoverEvent"),r.emit("PopupEvent.createFail")},1e3)}},"linear"))},function(e){console.log(e)})});var n=e(".light>img"),s=1;v=setInterval(function(){s>3&&(s=1),n.attr("src","/app/image/light"+s+".png"),s++},100),e(".rule-trigger").click(function(){r.emit("PopupEvent.rule")})}var a=(n(12),n(11)),r=n(5),o=n(9),c=n(7),d=n(4),l=-1,v=null,p=n(3),u=5,m=n(2);d.getUserId({loginid:p.getItem("loginid")||-1}).then(function(e){1==e.status&&(m.leave_times=e.times||0,p.saveItem("loginid",e.loginid))},function(){console.log("get user id error")}),r.on("homeEvent",function(){t()}),r.on("luckEvent",function(){s(),r.emit("PopupEvent.createFocus")}),r.on("PopupEvent.WriteMessage",function(e){o.createWriteMessage(e)}),r.on("PopupEvent.createFocus",function(){o.createFocus()}),r.on("PopupEvent.realAward",function(e){o.createRealAward(e)}),r.on("PopupEvent.virAwardEvent",function(e){o.createVirAward(e)}),r.on("PopupEvent.myAwardEvent",function(){o.createMyAward()}),r.on("coverEvent",function(){var t=e('<div class="cover"></div>');e(document.body).append(t)}),r.on("closeCoverEvent",function(){e(".cover").remove()}),r.on("PopupEvent.rule",function(){o.createRule()}),r.on("PopupEvent.createFail",function(){o.createFail()}),r.on("PopupEvent.createMessageSuccess",function(){o.createMessageSuccess()}),window.start=function(){r.emit("homeEvent")},r.emit("PopupEvent.virAwardEvent")}).call(t,n(1))},function(e,t){e.exports=jQuery},function(e,t){"use strict";var n=2;e.exports={leave_times:n}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){n(this,e)}return i(e,[{key:"getItem",value:function(e){return window.localStorage[e]}},{key:"saveItem",value:function(e,t){window.localStorage[e]=t}}]),e}(),a=new s;e.exports=a},function(e,t,n){(function(t){"use strict";function i(e){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=t("<div class='best'><div>正在加载信息...</div></div>");t(document.body).append(i);var s=t.ajax({type:"GET",url:e,data:n,dataType:"json"});return s.then(function(){t(".best").remove()},function(){t(".best").remove()}),s}function s(){return i("/Home/Award/myaward",{loginid:d})}function a(){return i("/Home/Award/one",{loginid:d})}function r(e){return i("/Home/Award/loginid",e)}function o(e){return e.loginid=d,i("/Home/Award/setAward",e)}var c=n(3),d=c.getItem("loginid")||-1;e.exports={getMyAward:s,getAward:a,submitMessage:o,getUserId:r}}).call(t,n(1))},function(e,t,n){"use strict";var i=n(10),s=new i.EventEmitter;e.exports=s},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){n(this,e),this._data=t,this._pagesize=3,this._index=-1}return i(e,[{key:"next",value:function(){this._index++;var e=this.getData();return e||this._index--,e}},{key:"pre",value:function(){this._index--;var e=this.getData();return e||this._index++,e}},{key:"hasNext",value:function(){var e=this._index*this._pagesize,t=e+this._pagesize-1;return!(t+1>=this._data.length)}},{key:"hasPrev",value:function(){return this._index>0}},{key:"getData",value:function(){for(var e=[],t=this._index*this._pagesize,n=t+this._pagesize-1,i=t;n>=i&&"undefined"!=typeof this._data[i];i++)e.push(this._data[i]);return e.length>0?e:!1}}]),e}();e.exports=function(e){return new s(e)}},function(e,t,n){(function(t){"use strict";function i(e){var t=o.award_mapping,n=null;if(1!=e.get){var i=[43,-90];return i[Math.floor(Math.random()*i.length)]}for(var s=0;s<t.length;s++)t[s].id==e.id&&(n=t[s].rotate);return n}function s(){var e=t.Deferred();return a.getAward().then(function(t){var n=i(t);return r.leave_times=t.times||0,e.resolve({rotate:n,data:t})},function(){e.reject("摇奖接口发生异常")}),e.promise()}var a=n(4),r=n(2),o={award_mapping:[{id:1,name:"10元微店优惠券",rotate:0},{id:2,name:"手机壳",rotate:135},{id:3,name:"阳伞",rotate:-135},{id:4,name:"5元微店优惠券",rotate:-180},{id:5,name:"球衣",rotate:90},{id:6,name:"足球",rotate:-45}]};e.exports={local_award_info:o,getAward:s}}).call(t,n(1))},function(e,t){"use strict";!function(e){e.fn.citySelect=function(t){if(!(this.length<1)){t=e.extend({url:"js/city.min.js",prov:null,city:null,dist:null,nodata:null,required:!0},t);var n,i=this,s=i.find(".prov"),a=i.find(".city"),r=i.find(".dist"),o=(t.prov,t.city,t.dist,t.required?"":"<option value=''>请选择</option>"),c=function(){var i=s.get(0).selectedIndex;if(t.required||i--,a.empty().attr("disabled",!0),r.empty().attr("disabled",!0),0>i||"undefined"==typeof n.citylist[i].c)return void("none"==t.nodata?(a.css("display","none"),r.css("display","none")):"hidden"==t.nodata&&(a.css("visibility","hidden"),r.css("visibility","hidden")));var c=o;e.each(n.citylist[i].c,function(e,t){c+="<option value='"+t.n+"'>"+t.n+"</option>"}),a.html(c).attr("disabled",!1).css({display:"",visibility:""}),d()},d=function(){var i=s.get(0).selectedIndex,c=a.get(0).selectedIndex;if(t.required||(i--,c--),r.empty().attr("disabled",!0),0>i||0>c||"undefined"==typeof n.citylist[i].c[c].a)return void("none"==t.nodata?r.css("display","none"):"hidden"==t.nodata&&r.css("visibility","hidden"));var d=o;e.each(n.citylist[i].c[c].a,function(e,t){d+="<option value='"+t.s+"'>"+t.s+"</option>"}),r.html(d).attr("disabled",!1).css({display:"",visibility:""})},l=function(){var i=o;e.each(n.citylist,function(e,t){i+="<option value='"+t.p+"'>"+t.p+"</option>"}),s.html(i),setTimeout(function(){null!=t.prov&&(s.val(t.prov),c(),setTimeout(function(){null!=t.city&&(a.val(t.city),d(),setTimeout(function(){null!=t.dist&&r.val(t.dist)},1))},1))},1),s.bind("change",function(){c()}),a.bind("change",function(){d()})};"string"==typeof t.url?e.getJSON(t.url,function(e){n=e,l()}):(n=t.url,l())}}}(jQuery)},function(e,t,n){(function(t){"use strict";function i(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0];h=t('<div class="popup"></div>'),t(document.body).append(h),e&&h.click(function(){t(this).remove(),t(".popup-content").remove(),h=null})}function s(){var e=arguments.length<=0||void 0===arguments[0]?{data:{gid:1}}:arguments[0],n=f.getItem("name")||"",s=f.getItem("address")||"",a=f.getItem("phone")||"",r='\n		<div class="write-message popup-content">\n			<div class="write-message-image"><img src="/app/image/message-bg.png"/></div>\n			<div class="write-form">\n				<input type=\'hidden\' value="'+e.data.gid+'" name=\'gid\'/>\n				<div class="write-item-manager">\n					<div class="write-item">\n						<div class="write-item-icon"><img src="/app/image/icon-1.png"/></div>\n						<div class=\'write-item-input\'><input type=\'text\' placeHolder="请输入姓名" name=\'username\' value=\''+n+"'/></div>\n					</div>\n\n					<div class=\"write-item\">\n						<div class=\"write-item-icon\"><img src=\"/app/image/icon-2.png\"/></div>\n						<div class='write-item-input'><input type='tel'  placeHolder=\"请输入手机号码\"  name='userphone' value='"+a+'\'/></div>\n					</div>\n\n			\n\n\n					<div class="write-item spec" id="scx">\n						<div class="shen"><select class=\'prov\'></select></div>\n						<div class="shi"><select class=\'city\'></select></div>\n						<div class="qu"><select class=\'dist\'></select></div>\n\n					</div>\n					\n					<div class="write-item">\n						<div class="write-item-icon"><img src="/app/image/icon-3.png"/></div>\n						<div class=\'write-item-input\'><input type=\'text\' placeHolder="请输入地址" name=\'useraddress\' value=\''+s+"'/></div>\n					</div>\n				</div>\n				<div class='write-message-submit-btn'><a href='javascript:void(0)'><img src=\"/app/image/submit-message.jpg\"/></a></div>\n			</div>\n		</div>\n	";i(!1),t(document.body).append(r),t("#scx").citySelect({url:"/app/js/city.min.js",prov:function(){return f.getItem("shen")||"北京"}(),city:function(){return f.getItem("shi")||"东城区"}(),dist:function(){return f.getItem("dist")||""}(),nodata:"none"}),t(".write-message-submit-btn>a").click(function(){var e=t("input[name='gid']").val(),n=t("input[name='username']").val(),i=t("input[name='userphone']").val(),s=t("input[name='useraddress']").val(),a=t(".prov").val(),r=t(".city").val(),o=t(".dist").val()||"";if(e.length<=0)return void alert("发生错误！请联系管理员!");if(n.length<=1)return void alert("请正确填写姓名");if(!/^1[0-9]{10}$/.test(i))return void alert("请正确填写手机号码");if(s.length<=5)return void alert("请正确填写地址");var c={gid:e,username:n,userphone:i,useraddress:a+r+o+s};f.saveItem("name",n),f.saveItem("phone",i),f.saveItem("address",s),f.saveItem("shen",a),f.saveItem("shi",r),f.saveItem("dist",o),m.submitMessage(c).then(function(e){p(),1==e.status?u.emit("PopupEvent.createMessageSuccess"):alert(e.info)},function(){p(),console.log("提交信息发生异常")})})}function a(){var e='\n		<div class="focus popup-content">\n			<div class=\'focus-tips\'><img src="/app/image/focus'+y.leave_times+'.png"/></div>\n\n			<div class="close-btn"><img src="/app/image/close-btn.jpg"/></div>\n		</div>\n	';i(),t(document.body).append(e),t(".close-btn").click(function(){p()})}function r(e){var n='\n		<div class="virAward popup-content">\n			<div class="vir-bg"><img src="'+e.data.pic+'"/></div>\n				<div class="star-manager">\n					<div><img src="/app/image/star-left.png"/></div>\n					<div><img src="/app/image/star-middle.png"/></div>\n					<div><img src="/app/image/star-right.png"/></div>\n				</div>\n		</div>\n\n	';t(document.body).append(n),i()}function o(e){console.log(e);var n='\n			<div class="realAward popup-content">\n				<div class="star-manager">\n					<div><img src="/app/image/star-left.png"/></div>\n					<div><img src="/app/image/star-middle.png"/></div>\n					<div><img src="/app/image/star-right.png"/></div>\n				</div>\n				<div class="realAward-image"><img src="'+e.data.pic+'"/></div>\n				<!--<div class="realAwardImage"><img src="/app/image/quan.png"/></div>-->\n				<div class="realAwardBtn"><img src="/app/image/btn.png"/></div>\n			<div>\n	';i(!1),t(document.body).append(n),t(".realAwardBtn").click(function(){p(),u.emit("PopupEvent.WriteMessage",e)})}function c(){m.getMyAward().then(function(e){var n=g(e.list),s='<div class="my-award-item">\n						<div class="my-award-left"><img src="/app/image/award-item-left.png"/><span>3.25</span></div>\n						<div class="my-award-middle">雨伞</div>\n						<div class="my-award-right">3</div>\n					</div>',a='\n			<div class="myAward popup-content">\n				<div class="xin-group">\n					<div><img src="/app/image/xin.png"/></div>\n					<div><img src="/app/image/xin.png"/></div>\n					<div><img src="/app/image/xin.png"/></div>\n				</div>\n\n				<div class="myaward-top"><img src="/app/image/my-top.png"/><span class="close-btn-2"><img src="/app/image/close-btn2.png"/></span></div>\n				<div class="myaward-middle">\n					\n				</div>\n				<div class="myaward-bottom"><img src="/app/image/my-bottom.png"/>\n					<div class="next-btn"><img src="/app/image/next.png"/></div>\n				</div>\n			<div>\n			';i(),t(document.body).append(a),t(".next-btn").click(function(){var e=n.next();if(e){t(".myaward-middle").contents().remove();for(var i=0;i<e.length;i++){var a=t(s);a.find(".my-award-left span").text(e[i].date),a.find(".my-award-middle").text(e[i].award_name),a.find(".my-award-right").text(e[i].award_number),t(".myaward-middle").append(a)}n.hasNext()||t(".next-btn").addClass("disabled")}else t(".next-btn").remove(),t(".myaward-middle").html("<div class='nodata'>暂时没有中奖数据！</div>")}),t(".next-btn").trigger("click"),t(".close-btn-2").click(function(){p()})},function(e){console.log("error in my award data")})}function d(){var e='\n			<div class="rule popup-content">\n				\n				<div class="rule-header"><img src="/app/image/rule-header.png"/>\n					\n					<div class="rule-close-btn"><img src="/app/image/close-btn2.png"/></div>\n\n				</div>\n				<div class="rule-content"><img src="/app/image/rule_content.png"/></div>\n\n\n\n			<div>\n	';i(!1),t(document.body).append(e),t(".rule-close-btn").click(function(){p()})}function l(){var e='\n			<div class="fail popup-content">\n				\n				<span>\n					<img src="/app/image/fail.png"/>\n					</span>\n\n\n			<div>\n	';i(!1),t(document.body).append(e),t(".fail").click(function(){p()})}function v(){var e='\n			<div class="messageSuccess popup-content">\n				\n				<div class=\'messageSuccess-content\'>\n					<div><img src="/app/image/message-success.png"/></div>\n					\n					<div class=\'myawardbtn2\'><img src="/app/image/myAwardBtn2.png"/></div>\n					<div class=\'message-close-btn\'><img src="/app/image/close-btn2.png"/></div>\n				</div>\n\n\n			<div>\n	';i(!1),t(document.body).append(e),t(".message-close-btn").click(function(){p()}),t(".myawardbtn2").click(function(){p(),u.emit("PopupEvent.myAwardEvent")})}function p(){h&&(h.remove(),t(".popup-content").remove(),h=null)}var u=n(5),m=n(4),g=n(6),f=n(3),h=null,y=n(2),w=n(8);console.log(w),e.exports={createWriteMessage:s,createFocus:a,createRealAward:o,createVirAward:r,createMessageSuccess:v,createMyAward:c,createRule:d,createFail:l}}).call(t,n(1))},function(e,t){"use strict";function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function s(e){return"number"==typeof e}function a(e){return"object"===("undefined"==typeof e?"undefined":o(e))&&null!==e}function r(e){return void 0===e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!s(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,o,c,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],r(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),d=n.slice(),s=d.length,c=0;s>c;c++)d[c].apply(this,o);return!0},n.prototype.addListener=function(e,t){var s;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(s=r(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,s&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,s,r,o;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],r=n.length,s=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(o=r;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){s=o;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){"use strict";function n(){return'<div class="home">\n				<div class="index-top">\n					<div class="title"><img src="/app/image/title.png"/></div>\n					<div class="dai">\n						<div class=\'dai-bg\'><img src="/app/image/top.png"/></div>\n						<div class="a-dai"><img src="/app/image/a-dai.png"/></div>\n					</div>\n				</div>\n				<div class="index-bottom">\n					<div class="start-btn"><a href=\'javascript:void(0)\'><img src="/app/image/btn-index.png"/></a></div>\n					<div class="index-logo"><img src="/app/image/logo-index.png"/></div>\n					<img src="/app/image/index-bottom.png" class=\'ib-bg\'/>\n				</div>\n\n				<div class="caidai">\n					<div class=\'dai-bg\'><img src="/app/image/caidai.png"/></div>\n				</div>\n			</div>'}function i(){return'<div class="luck">\n			<div class="luck-title">\n				<img src="/app/image/title2.png"/>\n				\n				<div class="jingbi"><img src="/app/image/luck-ani-1.png"/></div>\n				<div class="bao"><img src="/app/image/luck-ani-2.png"/></div>\n			</div>	\n		\n			<div class="pan">\n				<div class="round-pan"><img src="/app/image/pan.png"/></div>\n				<div class="zhizheng"><img src="/app/image/zhizheng.png"/></div>\n\n				<div class="light">\n					<img src="/app/image/light1.png"/>\n				</div>\n			</div>\n			<div class="myAwardBtn">\n\n				<div><a href=\'javascript:void(0)\' class=\'rule-trigger\'><img src="/app/image/rule_btn.png"/></a></div>\n				<div><a href=\'javascript:void(0)\'><img src="/app/image/times.png"/></a></div>\n				<div><a href=\'javascript:void(0)\' class=\'myaward_btn\'><img src="/app/image/myAwardBtn.png"/></a></div>\n\n\n			</div>\n		</div>'}e.exports={home:n,luck:i}},function(e,t){}]);